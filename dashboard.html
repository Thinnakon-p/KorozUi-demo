<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Dashboard - Add Post</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #121212;
            color: #f0f0f0;
        }
        /* Scrollable posts container */
        #postsList {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 2rem;
        }
        /* Scrollbar styling */
        #postsList::-webkit-scrollbar {
            width: 6px;
        }
        #postsList::-webkit-scrollbar-thumb {
            background-color: #ef4444;
            border-radius: 3px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <nav class="fixed w-full z-30 top-0 left-0 bg-gray-800">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a class="text-2xl font-bold" href="dashboard.html">Dashboard</a>
            <a class="text-2xl font-bold" href="iindex.html">View Posts</a>
        </div>
    </nav>
    <main class="flex-grow pt-24 max-w-7xl mx-auto px-6">
        <section class="py-16">
            <h2 class="text-3xl font-bold mb-8">Add New Post</h2>
            <form id="postForm" class="space-y-4">
                <input type="text" id="title" placeholder="Post Title" class="w-full p-2 rounded bg-gray-800 text-white" required/>
                <input type="text" id="description" placeholder="Description" class="w-full p-2 rounded bg-gray-800 text-white" required/>
                <input type="url" id="link" placeholder="Link" class="w-full p-2 rounded bg-gray-800 text-white" required/>
                <input type="file" id="image" accept="image/*" class="w-full p-2 rounded bg-gray-800 text-white" required/>
                <button type="submit" class="bg-red-600 text-white p-2 rounded">Add Post</button>
            </form>
        </section>

        <section class="py-16">
            <h2 class="text-3xl font-bold mb-6">Existing Posts</h2>
            <div id="postsList" class="space-y-4"></div>
        </section>
    </main>
    <script>
        const postForm = document.getElementById('postForm');
        const postsList = document.getElementById('postsList');

        function loadPosts() {
            const posts = JSON.parse(localStorage.getItem('posts')) || [];
            postsList.innerHTML = '';
            if(posts.length === 0) {
                postsList.innerHTML = '<p class="text-gray-400">No posts available.</p>';
                return;
            }
            posts.forEach((post, index) => {
                const postDiv = document.createElement('div');
                postDiv.className = 'bg-gray-800 p-4 rounded flex items-center space-x-4';
                postDiv.innerHTML = `
                    <img src="${post.image}" alt="${post.title}" class="w-20 h-20 object-cover rounded"/>
                    <div class="flex-grow">
                        <h3 class="text-lg font-bold">${post.title}</h3>
                        <p class="text-gray-300">${post.description}</p>
                        <a href="${post.link}" target="_blank" class="text-red-400 underline">Link</a>
                    </div>
                    <button class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700" data-index="${index}">Delete</button>
                `;
                postsList.appendChild(postDiv);
            });

            // Add delete event listeners
            postsList.querySelectorAll('button[data-index]').forEach(button => {
                button.addEventListener('click', (e) => {
                    const idx = parseInt(e.target.getAttribute('data-index'));
                    deletePost(idx);
                });
            });
        }

        function deletePost(index) {
            let posts = JSON.parse(localStorage.getItem('posts')) || [];
            posts.splice(index, 1);
            localStorage.setItem('posts', JSON.stringify(posts));
            loadPosts();
        }

        postForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            const link = document.getElementById('link').value.trim();
            const imageFile = document.getElementById('image').files[0];

            if (!title || !description || !link || !imageFile) {
                alert('Please fill all fields!');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const imageDataUrl = e.target.result;

                const post = {
                    title: title,
                    description: description,
                    link: link,
                    image: imageDataUrl
                };

                let posts = JSON.parse(localStorage.getItem('posts')) || [];
                posts.push(post);
                localStorage.setItem('posts', JSON.stringify(posts));

                alert('Post added successfully!');
                postForm.reset();
                loadPosts();
            };
            reader.readAsDataURL(imageFile);
        });

        window.onload = loadPosts;
    </script>
</body>
</html>

